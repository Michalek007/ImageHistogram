#include <stdio.h>
#include <stdlib.h>

#include "image_data.h"

const char* image_filename = "image_raw";

const uint32_t hist_gray[256] = {
        8963, 26673, 26155, 29717, 30684, 28041, 28992, 29730, 28653, 29055, 28476, 29506, 30332, 31596, 33365, 34834, 36621, 38065, 39956, 41464, 42715, 44529, 46358, 49122, 51598, 54353, 56209, 57750, 58646, 60487, 62839, 65153, 66969, 68262, 69643, 69217, 69894, 69978, 69974, 70304, 70723, 71004, 71988, 71889, 72935, 73565, 74319, 75191, 76165, 75779, 75879, 74225, 72677, 71167, 69090, 67667, 66492, 65070, 63850, 62187, 60264, 57952, 55979, 53740, 51380, 49531, 47996, 46794, 44969, 43909, 42514, 41083, 39856, 38926, 37289, 36608, 35122, 34050, 33066, 32221, 30767, 29867, 29097, 27874, 27342, 26263, 25835, 25121, 24328, 23455, 22790, 22495, 21683, 21183, 20554, 20125, 19695, 19073, 18735, 18473, 18051, 17640, 17332, 16972, 16921, 16329, 16259, 15661, 15237, 14945, 14716, 14336, 14196, 13869, 13851, 13603, 13186, 13399, 13080, 12612, 12758, 12314, 12316, 11966, 11771, 11676, 11297, 11032, 11054, 11199, 10995, 11002, 10633, 10831, 10823, 10557, 10854, 10704, 10841, 10812, 10835, 10674, 10781, 10693, 10769, 10823, 10782, 10684, 10558, 10636, 10467, 10581, 10700, 10311, 10485, 10193, 10449, 10339, 10662, 10429, 10209, 10204, 9999, 10060, 10041, 9924, 9978, 10009, 9764, 9753, 9925, 9741, 9666, 9825, 9663, 9760, 9379, 9635, 9339, 9603, 9578, 9523, 9369, 9310, 9262, 9307, 9359, 9349, 9433, 9283, 9389, 9405, 9123, 9233, 9195, 9260, 9134, 9131, 9037, 8961, 8895, 8923, 8970, 8902, 8693, 8835, 8480, 8223, 8231, 8087, 7887, 7716, 7562, 7265, 6987, 6769, 6438, 6008, 5676, 5460, 5294, 5278, 5316, 5175, 4718, 4538, 4104, 4029, 4166, 4111, 4211, 4384, 4412, 4076, 3657, 3514, 3529, 3650, 3984, 4174, 4210, 4187, 4353, 5183, 4109, 3187, 3113, 3313, 3127, 2283, 2154, 1901, 684, 365, 225, 936
};

int load_image(uint8_t* image){
    if (!image) {
        perror("image is NULL");
        return 0;
    }

    FILE *f = fopen(image_filename, "rb");
    if (!f) {
        perror("fopen");
        return 0;
    }
    size_t bytes_read = fread(image, 1, IMG_WIDTH * IMG_HEIGHT, f);
    printf("Image raw size: %llu\n", bytes_read);
    fclose(f);
    return bytes_read;
}