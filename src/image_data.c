#include <stdio.h>
#include <stdlib.h>

#include "image_data.h"

const char* image_filename = "image_raw";

const uint32_t hist_gray[256] = {
        3, 10, 16, 40, 139, 424, 933, 2290, 4653, 8905, 14112, 20428, 22001, 24903, 28539, 34385, 41907, 50988, 60758, 71130, 82477, 95358, 109752, 126101, 140466, 153915, 163895, 171544, 178669, 185734, 194829, 207168, 217693, 226354, 231816, 236101, 240104, 243779, 248300, 254212, 259272, 263313, 265228, 263066, 259801, 255230, 249056, 245222, 244666, 244516, 244379, 242427, 238364, 231504, 222266, 211680, 203380, 197163, 193105, 190001, 187063, 181903, 177406, 171589, 166703, 162702, 158784, 155762, 152609, 148315, 145968, 142737, 139856, 139782, 139957, 140561, 140994, 142068, 140414, 139616, 135958, 133092, 127471, 121768, 116319, 110091, 105265, 102469, 100785, 101323, 101839, 103864, 105108, 107433, 109019, 109175, 109034, 108119, 107383, 105712, 104103, 102081, 100532, 98746, 96177, 93244, 89086, 84600, 79816, 75208, 71980, 70319, 69032, 69403, 69172, 68820, 67661, 66138, 63834, 61439, 58708, 55524, 53072, 49993, 47866, 45988, 44611, 43001, 42030, 41437, 40835, 40546, 40138, 39705, 39686, 39659, 39180, 39440, 39404, 39683, 39443, 39952, 40492, 41089, 41313, 41735, 42356, 42806, 43542, 43575, 44462, 45096, 45093, 45556, 45930, 46340, 46697, 46367, 46372, 46561, 46084, 45569, 45424, 44668, 45171, 44986, 44704, 44640, 44409, 44811, 44673, 44569, 44555, 44720, 45572, 48543, 54086, 55901, 80460, 118990, 142254, 139015, 133662, 138526, 138127, 149127, 112129, 148435, 141514, 144728, 150405, 132365, 123587, 114101, 131435, 88385, 182209, 153996, 126012, 129761, 137593, 149790, 143062, 136779, 77601, 121324, 133223, 151795, 149187, 143642, 136433, 105739, 89623, 64768, 75520, 69762, 53017, 42720, 41447, 42198, 41031, 38481, 34876, 39189, 39852, 32977, 27520, 27535, 30134, 28699, 26830, 24201, 26327, 21528, 21109, 22522, 24548, 22694, 25403, 31095, 15235, 17787, 16801, 17477, 9560, 8979, 9071, 11159, 7831, 3813, 4338, 2212, 393, 56, 19, 27
};

int load_image(uint8_t* image){
    if (!image) {
        perror("image is NULL");
        return 0;
    }

    FILE *f = fopen(image_filename, "rb");
    if (!f) {
        perror("fopen");
        return 0;
    }
    size_t bytes_read = fread(image, 1, IMG_WIDTH * IMG_HEIGHT, f);
    printf("Image raw size: %llu\n", bytes_read);
    fclose(f);
    return bytes_read;
}